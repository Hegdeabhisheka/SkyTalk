{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:4000/api';\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor - Add token to requests\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('accessToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor - Handle token refresh\napi.interceptors.response.use(response => response, async error => {\n  var _error$response;\n  const originalRequest = error.config;\n\n  // If token expired and we haven't retried yet\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const refreshToken = localStorage.getItem('refreshToken');\n      const response = await axios.post(`${API_URL}/auth/refresh-token`, {\n        refreshToken\n      });\n      const {\n        accessToken\n      } = response.data;\n      localStorage.setItem('accessToken', accessToken);\n\n      // Retry original request with new token\n      originalRequest.headers.Authorization = `Bearer ${accessToken}`;\n      return api(originalRequest);\n    } catch (refreshError) {\n      // Refresh failed - logout user\n      localStorage.clear();\n      window.location.href = '/login';\n      return Promise.reject(refreshError);\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Auth endpoints\nexport const authAPI = {\n  register: data => api.post('/auth/register', data),\n  requestOTP: data => api.post('/auth/request-otp', data),\n  verifyOTP: data => api.post('/auth/verify-otp', data),\n  getCurrentUser: () => api.get('/auth/me')\n};\n\n// Friends endpoints\nexport const friendsAPI = {\n  searchUsers: query => api.get(`/friends/search?query=${query}`),\n  sendRequest: receiverId => api.post('/friends/request', {\n    receiverId\n  }),\n  getPendingRequests: () => api.get('/friends/requests/pending'),\n  getSentRequests: () => api.get('/friends/requests/sent'),\n  acceptRequest: requestId => api.post(`/friends/request/accept/${requestId}`),\n  rejectRequest: requestId => api.post(`/friends/request/reject/${requestId}`),\n  getFriendsList: () => api.get('/friends/list'),\n  removeFriend: friendId => api.delete(`/friends/${friendId}`)\n};\nexport default api;","map":{"version":3,"names":["axios","API_URL","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","originalRequest","status","_retry","refreshToken","post","accessToken","data","setItem","refreshError","clear","window","location","href","authAPI","register","requestOTP","verifyOTP","getCurrentUser","get","friendsAPI","searchUsers","query","sendRequest","receiverId","getPendingRequests","getSentRequests","acceptRequest","requestId","rejectRequest","getFriendsList","removeFriend","friendId","delete"],"sources":["A:/projects/SkyTalk/client/src/App.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = 'http://localhost:4000/api';\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Request interceptor - Add token to requests\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('accessToken');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor - Handle token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    // If token expired and we haven't retried yet\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        const refreshToken = localStorage.getItem('refreshToken');\n        const response = await axios.post(`${API_URL}/auth/refresh-token`, {\n          refreshToken,\n        });\n\n        const { accessToken } = response.data;\n        localStorage.setItem('accessToken', accessToken);\n\n        // Retry original request with new token\n        originalRequest.headers.Authorization = `Bearer ${accessToken}`;\n        return api(originalRequest);\n      } catch (refreshError) {\n        // Refresh failed - logout user\n        localStorage.clear();\n        window.location.href = '/login';\n        return Promise.reject(refreshError);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\n// Auth endpoints\nexport const authAPI = {\n  register: (data) => api.post('/auth/register', data),\n  requestOTP: (data) => api.post('/auth/request-otp', data),\n  verifyOTP: (data) => api.post('/auth/verify-otp', data),\n  getCurrentUser: () => api.get('/auth/me'),\n};\n\n// Friends endpoints\nexport const friendsAPI = {\n  searchUsers: (query) => api.get(`/friends/search?query=${query}`),\n  sendRequest: (receiverId) => api.post('/friends/request', { receiverId }),\n  getPendingRequests: () => api.get('/friends/requests/pending'),\n  getSentRequests: () => api.get('/friends/requests/sent'),\n  acceptRequest: (requestId) => api.post(`/friends/request/accept/${requestId}`),\n  rejectRequest: (requestId) => api.post(`/friends/request/reject/${requestId}`),\n  getFriendsList: () => api.get('/friends/list'),\n  removeFriend: (friendId) => api.delete(`/friends/${friendId}`),\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}