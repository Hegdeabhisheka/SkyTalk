{"ast":null,"code":"var _jsxFileName = \"A:\\\\Placment\\\\SkyTalk\\\\client\\\\src\\\\components\\\\Chat\\\\ChatWindow.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { chatAPI } from '../../services/api';\nimport { showNotification, playNotificationSound } from '../../services/notifications';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction ChatWindow({\n  friend,\n  socket,\n  isOnline\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [sending, setSending] = useState(false);\n  const [isTyping, setIsTyping] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [isUploading, setIsUploading] = useState(false);\n  const messagesEndRef = useRef(null);\n  const typingTimeoutRef = useRef(null);\n  const imageInputRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const currentUser = JSON.parse(localStorage.getItem('user'));\n  const loadMessages = useCallback(async () => {\n    setLoading(true);\n    try {\n      const response = await chatAPI.getConversation(friend.id);\n      setMessages(response.data.messages);\n    } catch (error) {\n      console.error('Error loading messages:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [friend.id]);\n  useEffect(() => {\n    loadMessages();\n  }, [loadMessages]);\n  const handleReceiveMessage = useCallback(messageData => {\n    if (messageData.sender.id === friend.id) {\n      setMessages(prev => [...prev, messageData]);\n      let notificationBody = messageData.message;\n      if (messageData.messageType === 'image') {\n        notificationBody = 'üì∑ Sent an image';\n      } else if (messageData.messageType === 'file') {\n        notificationBody = `üìé Sent a file: ${messageData.fileName}`;\n      }\n      showNotification(`New message from ${messageData.sender.username}`, {\n        body: notificationBody,\n        tag: `msg-${friend.id}`,\n        badge: 'üí¨'\n      });\n      playNotificationSound();\n    }\n  }, [friend.id]);\n  const handleMessageSent = useCallback(messageData => {\n    setMessages(prev => {\n      const updated = [...prev];\n      const lastMsg = updated[updated.length - 1];\n      if (lastMsg && !lastMsg.id) {\n        updated[updated.length - 1] = messageData;\n      }\n      return updated;\n    });\n  }, []);\n  const handleMessageDeletedPermanently = useCallback(data => {\n    const {\n      messageId\n    } = data;\n    // Remove the message completely\n    setMessages(prev => prev.filter(msg => msg.id !== messageId));\n  }, []);\n  const handleUserTyping = useCallback(data => {\n    if (data.userId === friend.id) {\n      setIsTyping(true);\n    }\n  }, [friend.id]);\n  const handleStopTyping = useCallback(data => {\n    if (data.userId === friend.id) {\n      setIsTyping(false);\n    }\n  }, [friend.id]);\n  useEffect(() => {\n    if (socket) {\n      socket.on('receive-message', handleReceiveMessage);\n      socket.on('message-sent', handleMessageSent);\n      socket.on('message-deleted-permanently', handleMessageDeletedPermanently);\n      socket.on('user-typing', handleUserTyping);\n      socket.on('user-stop-typing', handleStopTyping);\n      return () => {\n        socket.off('receive-message', handleReceiveMessage);\n        socket.off('message-sent', handleMessageSent);\n        socket.off('message-deleted-permanently', handleMessageDeletedPermanently);\n        socket.off('user-typing', handleUserTyping);\n        socket.off('user-stop-typing', handleStopTyping);\n      };\n    }\n  }, [socket, handleReceiveMessage, handleMessageSent, handleMessageDeletedPermanently, handleUserTyping, handleStopTyping]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const handleImageUpload = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    await uploadAndSendFile(file, 'image');\n  };\n  const handleFileUpload = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    await uploadAndSendFile(file, 'file');\n  };\n  const uploadAndSendFile = async (file, type) => {\n    setIsUploading(true);\n    setUploadProgress(0);\n    try {\n      const formData = new FormData();\n      formData.append(type === 'image' ? 'image' : 'file', file);\n      const uploadEndpoint = type === 'image' ? chatAPI.uploadImage : chatAPI.uploadFile;\n      console.log(`Uploading ${type}:`, file.name);\n      const response = await uploadEndpoint(formData);\n      console.log('Upload response:', response.data);\n      if (response.data.success) {\n        const {\n          fileUrl,\n          fileSize,\n          fileType\n        } = response.data;\n        const fileName = file.name; // Use original file name from laptop\n\n        const tempMessage = {\n          sender: {\n            id: currentUser.id,\n            username: currentUser.username,\n            avatar: currentUser.avatar\n          },\n          receiver: {\n            id: friend.id,\n            username: friend.username,\n            avatar: friend.avatar\n          },\n          message: type === 'image' ? 'üì∑ Image' : `üìé ${fileName}`,\n          messageType: type,\n          fileUrl,\n          fileName,\n          fileSize,\n          fileType,\n          timestamp: new Date(),\n          isRead: false\n        };\n        setMessages(prev => [...prev, tempMessage]);\n        setUploadProgress(0);\n        if (socket) {\n          socket.emit('send-message', {\n            receiverId: friend.id,\n            message: type === 'image' ? 'üì∑ Image' : `üìé ${fileName}`,\n            messageType: type,\n            fileUrl,\n            fileName,\n            fileSize,\n            fileType\n          });\n        }\n      }\n    } catch (error) {\n      console.error(`Error uploading ${type}:`, error);\n      alert(`Failed to upload ${type}. Please try again.`);\n    } finally {\n      setIsUploading(false);\n      setUploadProgress(0);\n      if (type === 'image' && imageInputRef.current) {\n        imageInputRef.current.value = '';\n      } else if (type === 'file' && fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (!newMessage.trim() || sending) return;\n    setSending(true);\n    const tempMessage = {\n      sender: {\n        id: currentUser.id,\n        username: currentUser.username,\n        avatar: currentUser.avatar\n      },\n      receiver: {\n        id: friend.id,\n        username: friend.username,\n        avatar: friend.avatar\n      },\n      message: newMessage.trim(),\n      messageType: 'text',\n      timestamp: new Date(),\n      isRead: false\n    };\n    setMessages(prev => [...prev, tempMessage]);\n    setNewMessage('');\n    if (socket) {\n      socket.emit('send-message', {\n        receiverId: friend.id,\n        message: newMessage.trim(),\n        messageType: 'text'\n      });\n    }\n    setSending(false);\n  };\n  const handleDeleteMessage = async messageId => {\n    if (!window.confirm('Delete this message permanently?')) return;\n    try {\n      await chatAPI.deleteMessage(messageId);\n\n      // Remove from UI immediately\n      setMessages(prev => prev.filter(msg => msg.id !== messageId));\n      if (socket) {\n        socket.emit('delete-message', {\n          messageId,\n          receiverId: friend.id\n        });\n      }\n    } catch (error) {\n      console.error('Error deleting message:', error);\n      alert('Failed to delete message');\n    }\n  };\n  const handleTyping = e => {\n    setNewMessage(e.target.value);\n    if (socket && e.target.value.length > 0) {\n      socket.emit('typing', {\n        receiverId: friend.id\n      });\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n      typingTimeoutRef.current = setTimeout(() => {\n        socket.emit('stop-typing', {\n          receiverId: friend.id\n        });\n      }, 2000);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage(e);\n    }\n  };\n  const formatTime = timestamp => {\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  const formatFileSize = bytes => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\n  };\n  const getFileIcon = fileType => {\n    if (fileType.includes('pdf')) return 'üìÑ';\n    if (fileType.includes('word') || fileType.includes('document')) return 'üìù';\n    if (fileType.includes('sheet') || fileType.includes('excel')) return 'üìä';\n    if (fileType.includes('presentation') || fileType.includes('powerpoint')) return 'üìΩÔ∏è';\n    if (fileType.includes('zip') || fileType.includes('rar')) return 'üì¶';\n    if (fileType.includes('audio')) return 'üéµ';\n    if (fileType.includes('video')) return 'üé¨';\n    return 'üìé';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-window\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-friend-avatar\",\n        children: friend.username.charAt(0).toUpperCase()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-friend-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-friend-name\",\n          children: friend.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-friend-status\",\n          children: isOnline ? 'üü¢ Online' : '‚ö´ Offline'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-container\",\n      children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'center',\n          padding: '2rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"spinner\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"empty-state\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-state-icon\",\n          children: \"\\uD83D\\uDC4B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"empty-state-title\",\n          children: \"Start the conversation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"empty-state-text\",\n          children: [\"Send a message to \", friend.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [messages.map((msg, index) => {\n          const isSent = msg.sender.id === currentUser.id;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `message ${isSent ? 'sent' : 'received'}`,\n            style: {\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-avatar\",\n              children: isSent ? currentUser.username.charAt(0).toUpperCase() : friend.username.charAt(0).toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-bubble\",\n                style: {\n                  position: 'relative'\n                },\n                children: [msg.messageType === 'text' && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"message-text\",\n                  children: msg.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 355,\n                  columnNumber: 25\n                }, this), msg.messageType === 'image' && /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: msg.fileUrl,\n                  download: msg.fileName || 'image.jpg',\n                  style: {\n                    textDecoration: 'none'\n                  },\n                  title: `Download: ${msg.fileName || 'image.jpg'}`,\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: msg.fileUrl,\n                    alt: \"attachment\",\n                    className: \"message-image\",\n                    style: {\n                      maxWidth: '300px',\n                      borderRadius: '8px',\n                      cursor: 'pointer'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 366,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 25\n                }, this), msg.messageType === 'file' && /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: msg.fileUrl,\n                  download: msg.fileName,\n                  className: \"message-file\",\n                  style: {\n                    textDecoration: 'none',\n                    color: 'inherit'\n                  },\n                  title: `Download: ${msg.fileName}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"file-icon\",\n                    children: getFileIcon(msg.fileType)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 383,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"file-info\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"file-name\",\n                      children: msg.fileName\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 387,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"file-size\",\n                      children: formatFileSize(msg.fileSize)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 388,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 386,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '1.5rem'\n                    },\n                    children: \"\\u2B07\\uFE0F\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 392,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 376,\n                  columnNumber: 25\n                }, this), isSent && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"message-actions\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"delete-btn\",\n                    onClick: () => handleDeleteMessage(msg.id),\n                    title: \"Delete message permanently\",\n                    children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 398,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 397,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-time\",\n                children: formatTime(msg.timestamp)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 408,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 19\n            }, this)]\n          }, msg.id || index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 17\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"typing-indicator\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"typing-dots\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"typing-dot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [friend.username, \" is typing...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), isUploading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"upload-progress\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Uploading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"progress-bar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-fill\",\n          style: {\n            width: `${uploadProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [uploadProgress, \"%\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message-input-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"file-upload-container\",\n        style: {\n          marginBottom: '0.5rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"file-upload-btn\",\n          onClick: () => {\n            var _imageInputRef$curren;\n            return (_imageInputRef$curren = imageInputRef.current) === null || _imageInputRef$curren === void 0 ? void 0 : _imageInputRef$curren.click();\n          },\n          title: \"Upload image\",\n          disabled: isUploading,\n          children: \"\\uD83D\\uDDBC\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: imageInputRef,\n          type: \"file\",\n          className: \"file-upload-input\",\n          accept: \"image/*\",\n          onChange: handleImageUpload,\n          disabled: isUploading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"file-upload-btn\",\n          onClick: () => {\n            var _fileInputRef$current;\n            return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n          },\n          title: \"Upload file\",\n          disabled: isUploading,\n          children: \"\\uD83D\\uDCCE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          className: \"file-upload-input\",\n          onChange: handleFileUpload,\n          disabled: isUploading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSendMessage,\n        className: \"message-input-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"message-input\",\n          placeholder: `Message ${friend.username}...`,\n          value: newMessage,\n          onChange: handleTyping,\n          onKeyPress: handleKeyPress,\n          rows: 1,\n          disabled: sending || isUploading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"send-button\",\n          disabled: !newMessage.trim() || sending || isUploading,\n          children: [sending ? '‚è≥' : 'üì§', \" Send\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatWindow, \"2S9JYIUw12Bq09ZRK0Xu7WCme98=\");\n_c = ChatWindow;\nexport default ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","chatAPI","showNotification","playNotificationSound","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatWindow","friend","socket","isOnline","_s","messages","setMessages","newMessage","setNewMessage","loading","setLoading","sending","setSending","isTyping","setIsTyping","uploadProgress","setUploadProgress","isUploading","setIsUploading","messagesEndRef","typingTimeoutRef","imageInputRef","fileInputRef","currentUser","JSON","parse","localStorage","getItem","loadMessages","response","getConversation","id","data","error","console","handleReceiveMessage","messageData","sender","prev","notificationBody","message","messageType","fileName","username","body","tag","badge","handleMessageSent","updated","lastMsg","length","handleMessageDeletedPermanently","messageId","filter","msg","handleUserTyping","userId","handleStopTyping","on","off","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleImageUpload","e","file","target","files","uploadAndSendFile","handleFileUpload","type","formData","FormData","append","uploadEndpoint","uploadImage","uploadFile","log","name","success","fileUrl","fileSize","fileType","tempMessage","avatar","receiver","timestamp","Date","isRead","emit","receiverId","alert","value","handleSendMessage","preventDefault","trim","handleDeleteMessage","window","confirm","deleteMessage","handleTyping","clearTimeout","setTimeout","handleKeyPress","key","shiftKey","formatTime","date","toLocaleTimeString","hour","minute","formatFileSize","bytes","k","sizes","i","Math","floor","round","pow","getFileIcon","includes","className","children","charAt","toUpperCase","_jsxFileName","lineNumber","columnNumber","style","textAlign","padding","map","index","isSent","position","href","download","textDecoration","title","src","alt","maxWidth","borderRadius","cursor","color","fontSize","onClick","ref","width","marginBottom","_imageInputRef$curren","click","disabled","accept","onChange","_fileInputRef$current","onSubmit","placeholder","onKeyPress","rows","_c","$RefreshReg$"],"sources":["A:/Placment/SkyTalk/client/src/components/Chat/ChatWindow.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { chatAPI } from '../../services/api';\r\nimport { showNotification, playNotificationSound } from '../../services/notifications';\r\n\r\nfunction ChatWindow({ friend, socket, isOnline }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [sending, setSending] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n  const imageInputRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n  const currentUser = JSON.parse(localStorage.getItem('user'));\r\n\r\n  const loadMessages = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await chatAPI.getConversation(friend.id);\r\n      setMessages(response.data.messages);\r\n    } catch (error) {\r\n      console.error('Error loading messages:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [friend.id]);\r\n\r\n  useEffect(() => {\r\n    loadMessages();\r\n  }, [loadMessages]);\r\n\r\n  const handleReceiveMessage = useCallback((messageData) => {\r\n    if (messageData.sender.id === friend.id) {\r\n      setMessages(prev => [...prev, messageData]);\r\n      \r\n      let notificationBody = messageData.message;\r\n      if (messageData.messageType === 'image') {\r\n        notificationBody = 'üì∑ Sent an image';\r\n      } else if (messageData.messageType === 'file') {\r\n        notificationBody = `üìé Sent a file: ${messageData.fileName}`;\r\n      }\r\n\r\n      showNotification(`New message from ${messageData.sender.username}`, {\r\n        body: notificationBody,\r\n        tag: `msg-${friend.id}`,\r\n        badge: 'üí¨'\r\n      });\r\n\r\n      playNotificationSound();\r\n    }\r\n  }, [friend.id]);\r\n\r\n  const handleMessageSent = useCallback((messageData) => {\r\n    setMessages(prev => {\r\n      const updated = [...prev];\r\n      const lastMsg = updated[updated.length - 1];\r\n      if (lastMsg && !lastMsg.id) {\r\n        updated[updated.length - 1] = messageData;\r\n      }\r\n      return updated;\r\n    });\r\n  }, []);\r\n\r\n  const handleMessageDeletedPermanently = useCallback((data) => {\r\n    const { messageId } = data;\r\n    // Remove the message completely\r\n    setMessages(prev => \r\n      prev.filter(msg => msg.id !== messageId)\r\n    );\r\n  }, []);\r\n\r\n  const handleUserTyping = useCallback((data) => {\r\n    if (data.userId === friend.id) {\r\n      setIsTyping(true);\r\n    }\r\n  }, [friend.id]);\r\n\r\n  const handleStopTyping = useCallback((data) => {\r\n    if (data.userId === friend.id) {\r\n      setIsTyping(false);\r\n    }\r\n  }, [friend.id]);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('receive-message', handleReceiveMessage);\r\n      socket.on('message-sent', handleMessageSent);\r\n      socket.on('message-deleted-permanently', handleMessageDeletedPermanently);\r\n      socket.on('user-typing', handleUserTyping);\r\n      socket.on('user-stop-typing', handleStopTyping);\r\n\r\n      return () => {\r\n        socket.off('receive-message', handleReceiveMessage);\r\n        socket.off('message-sent', handleMessageSent);\r\n        socket.off('message-deleted-permanently', handleMessageDeletedPermanently);\r\n        socket.off('user-typing', handleUserTyping);\r\n        socket.off('user-stop-typing', handleStopTyping);\r\n      };\r\n    }\r\n  }, [socket, handleReceiveMessage, handleMessageSent, handleMessageDeletedPermanently, handleUserTyping, handleStopTyping]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const handleImageUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    await uploadAndSendFile(file, 'image');\r\n  };\r\n\r\n  const handleFileUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    await uploadAndSendFile(file, 'file');\r\n  };\r\n\r\n  const uploadAndSendFile = async (file, type) => {\r\n    setIsUploading(true);\r\n    setUploadProgress(0);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(type === 'image' ? 'image' : 'file', file);\r\n\r\n      const uploadEndpoint = type === 'image' ? chatAPI.uploadImage : chatAPI.uploadFile;\r\n      \r\n      console.log(`Uploading ${type}:`, file.name);\r\n\r\n      const response = await uploadEndpoint(formData);\r\n      \r\n      console.log('Upload response:', response.data);\r\n\r\n      if (response.data.success) {\r\n        const { fileUrl, fileSize, fileType } = response.data;\r\n        const fileName = file.name; // Use original file name from laptop\r\n\r\n        const tempMessage = {\r\n          sender: {\r\n            id: currentUser.id,\r\n            username: currentUser.username,\r\n            avatar: currentUser.avatar\r\n          },\r\n          receiver: {\r\n            id: friend.id,\r\n            username: friend.username,\r\n            avatar: friend.avatar\r\n          },\r\n          message: type === 'image' ? 'üì∑ Image' : `üìé ${fileName}`,\r\n          messageType: type,\r\n          fileUrl,\r\n          fileName,\r\n          fileSize,\r\n          fileType,\r\n          timestamp: new Date(),\r\n          isRead: false\r\n        };\r\n\r\n        setMessages(prev => [...prev, tempMessage]);\r\n        setUploadProgress(0);\r\n\r\n        if (socket) {\r\n          socket.emit('send-message', {\r\n            receiverId: friend.id,\r\n            message: type === 'image' ? 'üì∑ Image' : `üìé ${fileName}`,\r\n            messageType: type,\r\n            fileUrl,\r\n            fileName,\r\n            fileSize,\r\n            fileType\r\n          });\r\n        }\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(`Error uploading ${type}:`, error);\r\n      alert(`Failed to upload ${type}. Please try again.`);\r\n    } finally {\r\n      setIsUploading(false);\r\n      setUploadProgress(0);\r\n      if (type === 'image' && imageInputRef.current) {\r\n        imageInputRef.current.value = '';\r\n      } else if (type === 'file' && fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!newMessage.trim() || sending) return;\r\n\r\n    setSending(true);\r\n\r\n    const tempMessage = {\r\n      sender: {\r\n        id: currentUser.id,\r\n        username: currentUser.username,\r\n        avatar: currentUser.avatar\r\n      },\r\n      receiver: {\r\n        id: friend.id,\r\n        username: friend.username,\r\n        avatar: friend.avatar\r\n      },\r\n      message: newMessage.trim(),\r\n      messageType: 'text',\r\n      timestamp: new Date(),\r\n      isRead: false\r\n    };\r\n\r\n    setMessages(prev => [...prev, tempMessage]);\r\n    setNewMessage('');\r\n\r\n    if (socket) {\r\n      socket.emit('send-message', {\r\n        receiverId: friend.id,\r\n        message: newMessage.trim(),\r\n        messageType: 'text'\r\n      });\r\n    }\r\n\r\n    setSending(false);\r\n  };\r\n\r\n  const handleDeleteMessage = async (messageId) => {\r\n    if (!window.confirm('Delete this message permanently?')) return;\r\n\r\n    try {\r\n      await chatAPI.deleteMessage(messageId);\r\n\r\n      // Remove from UI immediately\r\n      setMessages(prev =>\r\n        prev.filter(msg => msg.id !== messageId)\r\n      );\r\n\r\n      if (socket) {\r\n        socket.emit('delete-message', {\r\n          messageId,\r\n          receiverId: friend.id\r\n        });\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Error deleting message:', error);\r\n      alert('Failed to delete message');\r\n    }\r\n  };\r\n\r\n  const handleTyping = (e) => {\r\n    setNewMessage(e.target.value);\r\n\r\n    if (socket && e.target.value.length > 0) {\r\n      socket.emit('typing', { receiverId: friend.id });\r\n\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n\r\n      typingTimeoutRef.current = setTimeout(() => {\r\n        socket.emit('stop-typing', { receiverId: friend.id });\r\n      }, 2000);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage(e);\r\n    }\r\n  };\r\n\r\n  const formatTime = (timestamp) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleTimeString('en-US', { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\r\n  };\r\n\r\n  const getFileIcon = (fileType) => {\r\n    if (fileType.includes('pdf')) return 'üìÑ';\r\n    if (fileType.includes('word') || fileType.includes('document')) return 'üìù';\r\n    if (fileType.includes('sheet') || fileType.includes('excel')) return 'üìä';\r\n    if (fileType.includes('presentation') || fileType.includes('powerpoint')) return 'üìΩÔ∏è';\r\n    if (fileType.includes('zip') || fileType.includes('rar')) return 'üì¶';\r\n    if (fileType.includes('audio')) return 'üéµ';\r\n    if (fileType.includes('video')) return 'üé¨';\r\n    return 'üìé';\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-window\">\r\n      <div className=\"chat-header\">\r\n        <div className=\"chat-friend-avatar\">\r\n          {friend.username.charAt(0).toUpperCase()}\r\n        </div>\r\n        <div className=\"chat-friend-info\">\r\n          <div className=\"chat-friend-name\">{friend.username}</div>\r\n          <div className=\"chat-friend-status\">\r\n            {isOnline ? 'üü¢ Online' : '‚ö´ Offline'}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"messages-container\">\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\r\n            <div className=\"spinner\"></div>\r\n          </div>\r\n        ) : messages.length === 0 ? (\r\n          <div className=\"empty-state\">\r\n            <div className=\"empty-state-icon\">üëã</div>\r\n            <h3 className=\"empty-state-title\">Start the conversation</h3>\r\n            <p className=\"empty-state-text\">\r\n              Send a message to {friend.username}\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {messages.map((msg, index) => {\r\n              const isSent = msg.sender.id === currentUser.id;\r\n              \r\n              return (\r\n                <div\r\n                  key={msg.id || index}\r\n                  className={`message ${isSent ? 'sent' : 'received'}`}\r\n                  style={{ position: 'relative' }}\r\n                >\r\n                  <div className=\"message-avatar\">\r\n                    {isSent \r\n                      ? currentUser.username.charAt(0).toUpperCase()\r\n                      : friend.username.charAt(0).toUpperCase()\r\n                    }\r\n                  </div>\r\n                  <div className=\"message-content\">\r\n                    <div className=\"message-bubble\" style={{ position: 'relative' }}>\r\n                      {msg.messageType === 'text' && (\r\n                        <p className=\"message-text\">{msg.message}</p>\r\n                      )}\r\n                      \r\n                      {msg.messageType === 'image' && (\r\n                        <a \r\n                          href={msg.fileUrl} \r\n                          download={msg.fileName || 'image.jpg'}\r\n                          style={{ textDecoration: 'none' }}\r\n                          title={`Download: ${msg.fileName || 'image.jpg'}`}\r\n                        >\r\n                          {/* eslint-disable-next-line jsx-a11y/img-redundant-alt */}\r\n                          <img \r\n                            src={msg.fileUrl} \r\n                            alt=\"attachment\"\r\n                            className=\"message-image\"\r\n                            style={{ maxWidth: '300px', borderRadius: '8px', cursor: 'pointer' }}\r\n                          />\r\n                        </a>\r\n                      )}\r\n                      \r\n                      {msg.messageType === 'file' && (\r\n                        <a \r\n                          href={msg.fileUrl} \r\n                          download={msg.fileName}\r\n                          className=\"message-file\"\r\n                          style={{ textDecoration: 'none', color: 'inherit' }}\r\n                          title={`Download: ${msg.fileName}`}\r\n                        >\r\n                          <div className=\"file-icon\">\r\n                            {getFileIcon(msg.fileType)}\r\n                          </div>\r\n                          <div className=\"file-info\">\r\n                            <div className=\"file-name\">{msg.fileName}</div>\r\n                            <div className=\"file-size\">\r\n                              {formatFileSize(msg.fileSize)}\r\n                            </div>\r\n                          </div>\r\n                          <div style={{ fontSize: '1.5rem' }}>‚¨áÔ∏è</div>\r\n                        </a>\r\n                      )}\r\n\r\n                      {isSent && (\r\n                        <div className=\"message-actions\">\r\n                          <button\r\n                            className=\"delete-btn\"\r\n                            onClick={() => handleDeleteMessage(msg.id)}\r\n                            title=\"Delete message permanently\"\r\n                          >\r\n                            üóëÔ∏è Delete\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"message-time\">\r\n                      {formatTime(msg.timestamp)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n            <div ref={messagesEndRef} />\r\n          </>\r\n        )}\r\n\r\n        {isTyping && (\r\n          <div className=\"typing-indicator\">\r\n            <div className=\"typing-dots\">\r\n              <div className=\"typing-dot\"></div>\r\n              <div className=\"typing-dot\"></div>\r\n              <div className=\"typing-dot\"></div>\r\n            </div>\r\n            <span>{friend.username} is typing...</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Upload Progress */}\r\n      {isUploading && (\r\n        <div className=\"upload-progress\">\r\n          <span>Uploading...</span>\r\n          <div className=\"progress-bar\">\r\n            <div \r\n              className=\"progress-fill\" \r\n              style={{ width: `${uploadProgress}%` }}\r\n            ></div>\r\n          </div>\r\n          <span>{uploadProgress}%</span>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"message-input-container\">\r\n        <div className=\"file-upload-container\" style={{ marginBottom: '0.5rem' }}>\r\n          <button\r\n            type=\"button\"\r\n            className=\"file-upload-btn\"\r\n            onClick={() => imageInputRef.current?.click()}\r\n            title=\"Upload image\"\r\n            disabled={isUploading}\r\n          >\r\n            üñºÔ∏è\r\n          </button>\r\n          <input\r\n            ref={imageInputRef}\r\n            type=\"file\"\r\n            className=\"file-upload-input\"\r\n            accept=\"image/*\"\r\n            onChange={handleImageUpload}\r\n            disabled={isUploading}\r\n          />\r\n          \r\n          <button\r\n            type=\"button\"\r\n            className=\"file-upload-btn\"\r\n            onClick={() => fileInputRef.current?.click()}\r\n            title=\"Upload file\"\r\n            disabled={isUploading}\r\n          >\r\n            üìé\r\n          </button>\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            className=\"file-upload-input\"\r\n            onChange={handleFileUpload}\r\n            disabled={isUploading}\r\n          />\r\n        </div>\r\n\r\n        <form onSubmit={handleSendMessage} className=\"message-input-wrapper\">\r\n          <textarea\r\n            className=\"message-input\"\r\n            placeholder={`Message ${friend.username}...`}\r\n            value={newMessage}\r\n            onChange={handleTyping}\r\n            onKeyPress={handleKeyPress}\r\n            rows={1}\r\n            disabled={sending || isUploading}\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            className=\"send-button\"\r\n            disabled={!newMessage.trim() || sending || isUploading}\r\n          >\r\n            {sending ? '‚è≥' : 'üì§'} Send\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatWindow;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AACvE,SAASC,OAAO,QAAQ,oBAAoB;AAC5C,SAASC,gBAAgB,EAAEC,qBAAqB,QAAQ,8BAA8B;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEvF,SAASC,UAAUA,CAAC;EAAEC,MAAM;EAAEC,MAAM;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EAChD,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACkB,UAAU,EAAEC,aAAa,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACoB,OAAO,EAAEC,UAAU,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACsB,OAAO,EAAEC,UAAU,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACwB,QAAQ,EAAEC,WAAW,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAAC0B,cAAc,EAAEC,iBAAiB,CAAC,GAAG3B,QAAQ,CAAC,CAAC,CAAC;EACvD,MAAM,CAAC4B,WAAW,EAAEC,cAAc,CAAC,GAAG7B,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM8B,cAAc,GAAG5B,MAAM,CAAC,IAAI,CAAC;EACnC,MAAM6B,gBAAgB,GAAG7B,MAAM,CAAC,IAAI,CAAC;EACrC,MAAM8B,aAAa,GAAG9B,MAAM,CAAC,IAAI,CAAC;EAClC,MAAM+B,YAAY,GAAG/B,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMgC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;EAE5D,MAAMC,YAAY,GAAGpC,WAAW,CAAC,YAAY;IAC3CkB,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACF,MAAMmB,QAAQ,GAAG,MAAMpC,OAAO,CAACqC,eAAe,CAAC7B,MAAM,CAAC8B,EAAE,CAAC;MACzDzB,WAAW,CAACuB,QAAQ,CAACG,IAAI,CAAC3B,QAAQ,CAAC;IACrC,CAAC,CAAC,OAAO4B,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IACjD,CAAC,SAAS;MACRvB,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC,EAAE,CAACT,MAAM,CAAC8B,EAAE,CAAC,CAAC;EAEfzC,SAAS,CAAC,MAAM;IACdsC,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAElB,MAAMO,oBAAoB,GAAG3C,WAAW,CAAE4C,WAAW,IAAK;IACxD,IAAIA,WAAW,CAACC,MAAM,CAACN,EAAE,KAAK9B,MAAM,CAAC8B,EAAE,EAAE;MACvCzB,WAAW,CAACgC,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEF,WAAW,CAAC,CAAC;MAE3C,IAAIG,gBAAgB,GAAGH,WAAW,CAACI,OAAO;MAC1C,IAAIJ,WAAW,CAACK,WAAW,KAAK,OAAO,EAAE;QACvCF,gBAAgB,GAAG,kBAAkB;MACvC,CAAC,MAAM,IAAIH,WAAW,CAACK,WAAW,KAAK,MAAM,EAAE;QAC7CF,gBAAgB,GAAG,mBAAmBH,WAAW,CAACM,QAAQ,EAAE;MAC9D;MAEAhD,gBAAgB,CAAC,oBAAoB0C,WAAW,CAACC,MAAM,CAACM,QAAQ,EAAE,EAAE;QAClEC,IAAI,EAAEL,gBAAgB;QACtBM,GAAG,EAAE,OAAO5C,MAAM,CAAC8B,EAAE,EAAE;QACvBe,KAAK,EAAE;MACT,CAAC,CAAC;MAEFnD,qBAAqB,CAAC,CAAC;IACzB;EACF,CAAC,EAAE,CAACM,MAAM,CAAC8B,EAAE,CAAC,CAAC;EAEf,MAAMgB,iBAAiB,GAAGvD,WAAW,CAAE4C,WAAW,IAAK;IACrD9B,WAAW,CAACgC,IAAI,IAAI;MAClB,MAAMU,OAAO,GAAG,CAAC,GAAGV,IAAI,CAAC;MACzB,MAAMW,OAAO,GAAGD,OAAO,CAACA,OAAO,CAACE,MAAM,GAAG,CAAC,CAAC;MAC3C,IAAID,OAAO,IAAI,CAACA,OAAO,CAAClB,EAAE,EAAE;QAC1BiB,OAAO,CAACA,OAAO,CAACE,MAAM,GAAG,CAAC,CAAC,GAAGd,WAAW;MAC3C;MACA,OAAOY,OAAO;IAChB,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,+BAA+B,GAAG3D,WAAW,CAAEwC,IAAI,IAAK;IAC5D,MAAM;MAAEoB;IAAU,CAAC,GAAGpB,IAAI;IAC1B;IACA1B,WAAW,CAACgC,IAAI,IACdA,IAAI,CAACe,MAAM,CAACC,GAAG,IAAIA,GAAG,CAACvB,EAAE,KAAKqB,SAAS,CACzC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,gBAAgB,GAAG/D,WAAW,CAAEwC,IAAI,IAAK;IAC7C,IAAIA,IAAI,CAACwB,MAAM,KAAKvD,MAAM,CAAC8B,EAAE,EAAE;MAC7BjB,WAAW,CAAC,IAAI,CAAC;IACnB;EACF,CAAC,EAAE,CAACb,MAAM,CAAC8B,EAAE,CAAC,CAAC;EAEf,MAAM0B,gBAAgB,GAAGjE,WAAW,CAAEwC,IAAI,IAAK;IAC7C,IAAIA,IAAI,CAACwB,MAAM,KAAKvD,MAAM,CAAC8B,EAAE,EAAE;MAC7BjB,WAAW,CAAC,KAAK,CAAC;IACpB;EACF,CAAC,EAAE,CAACb,MAAM,CAAC8B,EAAE,CAAC,CAAC;EAEfzC,SAAS,CAAC,MAAM;IACd,IAAIY,MAAM,EAAE;MACVA,MAAM,CAACwD,EAAE,CAAC,iBAAiB,EAAEvB,oBAAoB,CAAC;MAClDjC,MAAM,CAACwD,EAAE,CAAC,cAAc,EAAEX,iBAAiB,CAAC;MAC5C7C,MAAM,CAACwD,EAAE,CAAC,6BAA6B,EAAEP,+BAA+B,CAAC;MACzEjD,MAAM,CAACwD,EAAE,CAAC,aAAa,EAAEH,gBAAgB,CAAC;MAC1CrD,MAAM,CAACwD,EAAE,CAAC,kBAAkB,EAAED,gBAAgB,CAAC;MAE/C,OAAO,MAAM;QACXvD,MAAM,CAACyD,GAAG,CAAC,iBAAiB,EAAExB,oBAAoB,CAAC;QACnDjC,MAAM,CAACyD,GAAG,CAAC,cAAc,EAAEZ,iBAAiB,CAAC;QAC7C7C,MAAM,CAACyD,GAAG,CAAC,6BAA6B,EAAER,+BAA+B,CAAC;QAC1EjD,MAAM,CAACyD,GAAG,CAAC,aAAa,EAAEJ,gBAAgB,CAAC;QAC3CrD,MAAM,CAACyD,GAAG,CAAC,kBAAkB,EAAEF,gBAAgB,CAAC;MAClD,CAAC;IACH;EACF,CAAC,EAAE,CAACvD,MAAM,EAAEiC,oBAAoB,EAAEY,iBAAiB,EAAEI,+BAA+B,EAAEI,gBAAgB,EAAEE,gBAAgB,CAAC,CAAC;EAE1HnE,SAAS,CAAC,MAAM;IACdsE,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACvD,QAAQ,CAAC,CAAC;EAEd,MAAMuD,cAAc,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA;IAC3B,CAAAA,qBAAA,GAAA1C,cAAc,CAAC2C,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBE,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC;EAED,MAAMC,iBAAiB,GAAG,MAAOC,CAAC,IAAK;IACrC,MAAMC,IAAI,GAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;IACX,MAAMG,iBAAiB,CAACH,IAAI,EAAE,OAAO,CAAC;EACxC,CAAC;EAED,MAAMI,gBAAgB,GAAG,MAAOL,CAAC,IAAK;IACpC,MAAMC,IAAI,GAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;IACX,MAAMG,iBAAiB,CAACH,IAAI,EAAE,MAAM,CAAC;EACvC,CAAC;EAED,MAAMG,iBAAiB,GAAG,MAAAA,CAAOH,IAAI,EAAEK,IAAI,KAAK;IAC9CtD,cAAc,CAAC,IAAI,CAAC;IACpBF,iBAAiB,CAAC,CAAC,CAAC;IAEpB,IAAI;MACF,MAAMyD,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAACH,IAAI,KAAK,OAAO,GAAG,OAAO,GAAG,MAAM,EAAEL,IAAI,CAAC;MAE1D,MAAMS,cAAc,GAAGJ,IAAI,KAAK,OAAO,GAAG/E,OAAO,CAACoF,WAAW,GAAGpF,OAAO,CAACqF,UAAU;MAElF5C,OAAO,CAAC6C,GAAG,CAAC,aAAaP,IAAI,GAAG,EAAEL,IAAI,CAACa,IAAI,CAAC;MAE5C,MAAMnD,QAAQ,GAAG,MAAM+C,cAAc,CAACH,QAAQ,CAAC;MAE/CvC,OAAO,CAAC6C,GAAG,CAAC,kBAAkB,EAAElD,QAAQ,CAACG,IAAI,CAAC;MAE9C,IAAIH,QAAQ,CAACG,IAAI,CAACiD,OAAO,EAAE;QACzB,MAAM;UAAEC,OAAO;UAAEC,QAAQ;UAAEC;QAAS,CAAC,GAAGvD,QAAQ,CAACG,IAAI;QACrD,MAAMU,QAAQ,GAAGyB,IAAI,CAACa,IAAI,CAAC,CAAC;;QAE5B,MAAMK,WAAW,GAAG;UAClBhD,MAAM,EAAE;YACNN,EAAE,EAAER,WAAW,CAACQ,EAAE;YAClBY,QAAQ,EAAEpB,WAAW,CAACoB,QAAQ;YAC9B2C,MAAM,EAAE/D,WAAW,CAAC+D;UACtB,CAAC;UACDC,QAAQ,EAAE;YACRxD,EAAE,EAAE9B,MAAM,CAAC8B,EAAE;YACbY,QAAQ,EAAE1C,MAAM,CAAC0C,QAAQ;YACzB2C,MAAM,EAAErF,MAAM,CAACqF;UACjB,CAAC;UACD9C,OAAO,EAAEgC,IAAI,KAAK,OAAO,GAAG,UAAU,GAAG,MAAM9B,QAAQ,EAAE;UACzDD,WAAW,EAAE+B,IAAI;UACjBU,OAAO;UACPxC,QAAQ;UACRyC,QAAQ;UACRC,QAAQ;UACRI,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;UACrBC,MAAM,EAAE;QACV,CAAC;QAEDpF,WAAW,CAACgC,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE+C,WAAW,CAAC,CAAC;QAC3CrE,iBAAiB,CAAC,CAAC,CAAC;QAEpB,IAAId,MAAM,EAAE;UACVA,MAAM,CAACyF,IAAI,CAAC,cAAc,EAAE;YAC1BC,UAAU,EAAE3F,MAAM,CAAC8B,EAAE;YACrBS,OAAO,EAAEgC,IAAI,KAAK,OAAO,GAAG,UAAU,GAAG,MAAM9B,QAAQ,EAAE;YACzDD,WAAW,EAAE+B,IAAI;YACjBU,OAAO;YACPxC,QAAQ;YACRyC,QAAQ;YACRC;UACF,CAAC,CAAC;QACJ;MACF;IAEF,CAAC,CAAC,OAAOnD,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mBAAmBuC,IAAI,GAAG,EAAEvC,KAAK,CAAC;MAChD4D,KAAK,CAAC,oBAAoBrB,IAAI,qBAAqB,CAAC;IACtD,CAAC,SAAS;MACRtD,cAAc,CAAC,KAAK,CAAC;MACrBF,iBAAiB,CAAC,CAAC,CAAC;MACpB,IAAIwD,IAAI,KAAK,OAAO,IAAInD,aAAa,CAACyC,OAAO,EAAE;QAC7CzC,aAAa,CAACyC,OAAO,CAACgC,KAAK,GAAG,EAAE;MAClC,CAAC,MAAM,IAAItB,IAAI,KAAK,MAAM,IAAIlD,YAAY,CAACwC,OAAO,EAAE;QAClDxC,YAAY,CAACwC,OAAO,CAACgC,KAAK,GAAG,EAAE;MACjC;IACF;EACF,CAAC;EAED,MAAMC,iBAAiB,GAAI7B,CAAC,IAAK;IAC/BA,CAAC,CAAC8B,cAAc,CAAC,CAAC;IAElB,IAAI,CAACzF,UAAU,CAAC0F,IAAI,CAAC,CAAC,IAAItF,OAAO,EAAE;IAEnCC,UAAU,CAAC,IAAI,CAAC;IAEhB,MAAMyE,WAAW,GAAG;MAClBhD,MAAM,EAAE;QACNN,EAAE,EAAER,WAAW,CAACQ,EAAE;QAClBY,QAAQ,EAAEpB,WAAW,CAACoB,QAAQ;QAC9B2C,MAAM,EAAE/D,WAAW,CAAC+D;MACtB,CAAC;MACDC,QAAQ,EAAE;QACRxD,EAAE,EAAE9B,MAAM,CAAC8B,EAAE;QACbY,QAAQ,EAAE1C,MAAM,CAAC0C,QAAQ;QACzB2C,MAAM,EAAErF,MAAM,CAACqF;MACjB,CAAC;MACD9C,OAAO,EAAEjC,UAAU,CAAC0F,IAAI,CAAC,CAAC;MAC1BxD,WAAW,EAAE,MAAM;MACnB+C,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;MACrBC,MAAM,EAAE;IACV,CAAC;IAEDpF,WAAW,CAACgC,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE+C,WAAW,CAAC,CAAC;IAC3C7E,aAAa,CAAC,EAAE,CAAC;IAEjB,IAAIN,MAAM,EAAE;MACVA,MAAM,CAACyF,IAAI,CAAC,cAAc,EAAE;QAC1BC,UAAU,EAAE3F,MAAM,CAAC8B,EAAE;QACrBS,OAAO,EAAEjC,UAAU,CAAC0F,IAAI,CAAC,CAAC;QAC1BxD,WAAW,EAAE;MACf,CAAC,CAAC;IACJ;IAEA7B,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC;EAED,MAAMsF,mBAAmB,GAAG,MAAO9C,SAAS,IAAK;IAC/C,IAAI,CAAC+C,MAAM,CAACC,OAAO,CAAC,kCAAkC,CAAC,EAAE;IAEzD,IAAI;MACF,MAAM3G,OAAO,CAAC4G,aAAa,CAACjD,SAAS,CAAC;;MAEtC;MACA9C,WAAW,CAACgC,IAAI,IACdA,IAAI,CAACe,MAAM,CAACC,GAAG,IAAIA,GAAG,CAACvB,EAAE,KAAKqB,SAAS,CACzC,CAAC;MAED,IAAIlD,MAAM,EAAE;QACVA,MAAM,CAACyF,IAAI,CAAC,gBAAgB,EAAE;UAC5BvC,SAAS;UACTwC,UAAU,EAAE3F,MAAM,CAAC8B;QACrB,CAAC,CAAC;MACJ;IAEF,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C4D,KAAK,CAAC,0BAA0B,CAAC;IACnC;EACF,CAAC;EAED,MAAMS,YAAY,GAAIpC,CAAC,IAAK;IAC1B1D,aAAa,CAAC0D,CAAC,CAACE,MAAM,CAAC0B,KAAK,CAAC;IAE7B,IAAI5F,MAAM,IAAIgE,CAAC,CAACE,MAAM,CAAC0B,KAAK,CAAC5C,MAAM,GAAG,CAAC,EAAE;MACvChD,MAAM,CAACyF,IAAI,CAAC,QAAQ,EAAE;QAAEC,UAAU,EAAE3F,MAAM,CAAC8B;MAAG,CAAC,CAAC;MAEhD,IAAIX,gBAAgB,CAAC0C,OAAO,EAAE;QAC5ByC,YAAY,CAACnF,gBAAgB,CAAC0C,OAAO,CAAC;MACxC;MAEA1C,gBAAgB,CAAC0C,OAAO,GAAG0C,UAAU,CAAC,MAAM;QAC1CtG,MAAM,CAACyF,IAAI,CAAC,aAAa,EAAE;UAAEC,UAAU,EAAE3F,MAAM,CAAC8B;QAAG,CAAC,CAAC;MACvD,CAAC,EAAE,IAAI,CAAC;IACV;EACF,CAAC;EAED,MAAM0E,cAAc,GAAIvC,CAAC,IAAK;IAC5B,IAAIA,CAAC,CAACwC,GAAG,KAAK,OAAO,IAAI,CAACxC,CAAC,CAACyC,QAAQ,EAAE;MACpCzC,CAAC,CAAC8B,cAAc,CAAC,CAAC;MAClBD,iBAAiB,CAAC7B,CAAC,CAAC;IACtB;EACF,CAAC;EAED,MAAM0C,UAAU,GAAIpB,SAAS,IAAK;IAChC,MAAMqB,IAAI,GAAG,IAAIpB,IAAI,CAACD,SAAS,CAAC;IAChC,OAAOqB,IAAI,CAACC,kBAAkB,CAAC,OAAO,EAAE;MACtCC,IAAI,EAAE,SAAS;MACfC,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC;EAED,MAAMC,cAAc,GAAIC,KAAK,IAAK;IAChC,IAAIA,KAAK,KAAK,CAAC,EAAE,OAAO,SAAS;IACjC,MAAMC,CAAC,GAAG,IAAI;IACd,MAAMC,KAAK,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;IACzC,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACvC,GAAG,CAACmC,KAAK,CAAC,GAAGI,IAAI,CAACvC,GAAG,CAACoC,CAAC,CAAC,CAAC;IACnD,OAAOG,IAAI,CAACE,KAAK,CAAEN,KAAK,GAAGI,IAAI,CAACG,GAAG,CAACN,CAAC,EAAEE,CAAC,CAAC,GAAI,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAGD,KAAK,CAACC,CAAC,CAAC;EAC1E,CAAC;EAED,MAAMK,WAAW,GAAItC,QAAQ,IAAK;IAChC,IAAIA,QAAQ,CAACuC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,IAAI;IACzC,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,MAAM,CAAC,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,IAAI;IAC3E,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,OAAO,CAAC,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,IAAI;IACzE,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,cAAc,CAAC,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,YAAY,CAAC,EAAE,OAAO,KAAK;IACtF,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,KAAK,CAAC,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,IAAI;IACrE,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,IAAI;IAC3C,IAAIvC,QAAQ,CAACuC,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,IAAI;IAC3C,OAAO,IAAI;EACb,CAAC;EAED,oBACE9H,OAAA;IAAK+H,SAAS,EAAC,aAAa;IAAAC,QAAA,gBAC1BhI,OAAA;MAAK+H,SAAS,EAAC,aAAa;MAAAC,QAAA,gBAC1BhI,OAAA;QAAK+H,SAAS,EAAC,oBAAoB;QAAAC,QAAA,EAChC5H,MAAM,CAAC0C,QAAQ,CAACmF,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC;MAAC;QAAArF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrC,CAAC,eACNrI,OAAA;QAAK+H,SAAS,EAAC,kBAAkB;QAAAC,QAAA,gBAC/BhI,OAAA;UAAK+H,SAAS,EAAC,kBAAkB;UAAAC,QAAA,EAAE5H,MAAM,CAAC0C;QAAQ;UAAAD,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACzDrI,OAAA;UAAK+H,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAChC1H,QAAQ,GAAG,WAAW,GAAG;QAAW;UAAAuC,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClC,CAAC;MAAA;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAxF,QAAA,EAAAsF,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAENrI,OAAA;MAAK+H,SAAS,EAAC,oBAAoB;MAAAC,QAAA,GAChCpH,OAAO,gBACNZ,OAAA;QAAKsI,KAAK,EAAE;UAAEC,SAAS,EAAE,QAAQ;UAAEC,OAAO,EAAE;QAAO,CAAE;QAAAR,QAAA,eACnDhI,OAAA;UAAK+H,SAAS,EAAC;QAAS;UAAAlF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM;MAAC;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5B,CAAC,GACJ7H,QAAQ,CAAC6C,MAAM,KAAK,CAAC,gBACvBrD,OAAA;QAAK+H,SAAS,EAAC,aAAa;QAAAC,QAAA,gBAC1BhI,OAAA;UAAK+H,SAAS,EAAC,kBAAkB;UAAAC,QAAA,EAAC;QAAE;UAAAnF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAC1CrI,OAAA;UAAI+H,SAAS,EAAC,mBAAmB;UAAAC,QAAA,EAAC;QAAsB;UAAAnF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC7DrI,OAAA;UAAG+H,SAAS,EAAC,kBAAkB;UAAAC,QAAA,GAAC,oBACZ,EAAC5H,MAAM,CAAC0C,QAAQ;QAAA;UAAAD,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACjC,CAAC;MAAA;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,gBAENrI,OAAA,CAAAE,SAAA;QAAA8H,QAAA,GACGxH,QAAQ,CAACiI,GAAG,CAAC,CAAChF,GAAG,EAAEiF,KAAK,KAAK;UAC5B,MAAMC,MAAM,GAAGlF,GAAG,CAACjB,MAAM,CAACN,EAAE,KAAKR,WAAW,CAACQ,EAAE;UAE/C,oBACElC,OAAA;YAEE+H,SAAS,EAAE,WAAWY,MAAM,GAAG,MAAM,GAAG,UAAU,EAAG;YACrDL,KAAK,EAAE;cAAEM,QAAQ,EAAE;YAAW,CAAE;YAAAZ,QAAA,gBAEhChI,OAAA;cAAK+H,SAAS,EAAC,gBAAgB;cAAAC,QAAA,EAC5BW,MAAM,GACHjH,WAAW,CAACoB,QAAQ,CAACmF,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAC5C9H,MAAM,CAAC0C,QAAQ,CAACmF,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC;YAAC;cAAArF,QAAA,EAAAsF,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAExC,CAAC,eACNrI,OAAA;cAAK+H,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAC9BhI,OAAA;gBAAK+H,SAAS,EAAC,gBAAgB;gBAACO,KAAK,EAAE;kBAAEM,QAAQ,EAAE;gBAAW,CAAE;gBAAAZ,QAAA,GAC7DvE,GAAG,CAACb,WAAW,KAAK,MAAM,iBACzB5C,OAAA;kBAAG+H,SAAS,EAAC,cAAc;kBAAAC,QAAA,EAAEvE,GAAG,CAACd;gBAAO;kBAAAE,QAAA,EAAAsF,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAC7C,EAEA5E,GAAG,CAACb,WAAW,KAAK,OAAO,iBAC1B5C,OAAA;kBACE6I,IAAI,EAAEpF,GAAG,CAAC4B,OAAQ;kBAClByD,QAAQ,EAAErF,GAAG,CAACZ,QAAQ,IAAI,WAAY;kBACtCyF,KAAK,EAAE;oBAAES,cAAc,EAAE;kBAAO,CAAE;kBAClCC,KAAK,EAAE,aAAavF,GAAG,CAACZ,QAAQ,IAAI,WAAW,EAAG;kBAAAmF,QAAA,eAGlDhI,OAAA;oBACEiJ,GAAG,EAAExF,GAAG,CAAC4B,OAAQ;oBACjB6D,GAAG,EAAC,YAAY;oBAChBnB,SAAS,EAAC,eAAe;oBACzBO,KAAK,EAAE;sBAAEa,QAAQ,EAAE,OAAO;sBAAEC,YAAY,EAAE,KAAK;sBAAEC,MAAM,EAAE;oBAAU;kBAAE;oBAAAxG,QAAA,EAAAsF,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACtE;gBAAC;kBAAAxF,QAAA,EAAAsF,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD,CACJ,EAEA5E,GAAG,CAACb,WAAW,KAAK,MAAM,iBACzB5C,OAAA;kBACE6I,IAAI,EAAEpF,GAAG,CAAC4B,OAAQ;kBAClByD,QAAQ,EAAErF,GAAG,CAACZ,QAAS;kBACvBkF,SAAS,EAAC,cAAc;kBACxBO,KAAK,EAAE;oBAAES,cAAc,EAAE,MAAM;oBAAEO,KAAK,EAAE;kBAAU,CAAE;kBACpDN,KAAK,EAAE,aAAavF,GAAG,CAACZ,QAAQ,EAAG;kBAAAmF,QAAA,gBAEnChI,OAAA;oBAAK+H,SAAS,EAAC,WAAW;oBAAAC,QAAA,EACvBH,WAAW,CAACpE,GAAG,CAAC8B,QAAQ;kBAAC;oBAAA1C,QAAA,EAAAsF,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACvB,CAAC,eACNrI,OAAA;oBAAK+H,SAAS,EAAC,WAAW;oBAAAC,QAAA,gBACxBhI,OAAA;sBAAK+H,SAAS,EAAC,WAAW;sBAAAC,QAAA,EAAEvE,GAAG,CAACZ;oBAAQ;sBAAAA,QAAA,EAAAsF,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAAC,eAC/CrI,OAAA;sBAAK+H,SAAS,EAAC,WAAW;sBAAAC,QAAA,EACvBZ,cAAc,CAAC3D,GAAG,CAAC6B,QAAQ;oBAAC;sBAAAzC,QAAA,EAAAsF,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAC1B,CAAC;kBAAA;oBAAAxF,QAAA,EAAAsF,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACH,CAAC,eACNrI,OAAA;oBAAKsI,KAAK,EAAE;sBAAEiB,QAAQ,EAAE;oBAAS,CAAE;oBAAAvB,QAAA,EAAC;kBAAE;oBAAAnF,QAAA,EAAAsF,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC;gBAAA;kBAAAxF,QAAA,EAAAsF,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC3C,CACJ,EAEAM,MAAM,iBACL3I,OAAA;kBAAK+H,SAAS,EAAC,iBAAiB;kBAAAC,QAAA,eAC9BhI,OAAA;oBACE+H,SAAS,EAAC,YAAY;oBACtByB,OAAO,EAAEA,CAAA,KAAMnD,mBAAmB,CAAC5C,GAAG,CAACvB,EAAE,CAAE;oBAC3C8G,KAAK,EAAC,4BAA4B;oBAAAhB,QAAA,EACnC;kBAED;oBAAAnF,QAAA,EAAAsF,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ;gBAAC;kBAAAxF,QAAA,EAAAsF,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACN,CACN;cAAA;gBAAAxF,QAAA,EAAAsF,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC,eACNrI,OAAA;gBAAK+H,SAAS,EAAC,cAAc;gBAAAC,QAAA,EAC1BjB,UAAU,CAACtD,GAAG,CAACkC,SAAS;cAAC;gBAAA9C,QAAA,EAAAsF,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACvB,CAAC;YAAA;cAAAxF,QAAA,EAAAsF,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA,GArED5E,GAAG,CAACvB,EAAE,IAAIwG,KAAK;YAAA7F,QAAA,EAAAsF,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAsEjB,CAAC;QAEV,CAAC,CAAC,eACFrI,OAAA;UAAKyJ,GAAG,EAAEnI;QAAe;UAAAuB,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAAA,eAC5B,CACH,EAEArH,QAAQ,iBACPhB,OAAA;QAAK+H,SAAS,EAAC,kBAAkB;QAAAC,QAAA,gBAC/BhI,OAAA;UAAK+H,SAAS,EAAC,aAAa;UAAAC,QAAA,gBAC1BhI,OAAA;YAAK+H,SAAS,EAAC;UAAY;YAAAlF,QAAA,EAAAsF,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAClCrI,OAAA;YAAK+H,SAAS,EAAC;UAAY;YAAAlF,QAAA,EAAAsF,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAClCrI,OAAA;YAAK+H,SAAS,EAAC;UAAY;YAAAlF,QAAA,EAAAsF,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAxF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC,eACNrI,OAAA;UAAAgI,QAAA,GAAO5H,MAAM,CAAC0C,QAAQ,EAAC,eAAa;QAAA;UAAAD,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxC,CACN;IAAA;MAAAxF,QAAA,EAAAsF,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGLjH,WAAW,iBACVpB,OAAA;MAAK+H,SAAS,EAAC,iBAAiB;MAAAC,QAAA,gBAC9BhI,OAAA;QAAAgI,QAAA,EAAM;MAAY;QAAAnF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACzBrI,OAAA;QAAK+H,SAAS,EAAC,cAAc;QAAAC,QAAA,eAC3BhI,OAAA;UACE+H,SAAS,EAAC,eAAe;UACzBO,KAAK,EAAE;YAAEoB,KAAK,EAAE,GAAGxI,cAAc;UAAI;QAAE;UAAA2B,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnC;MAAC;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,eACNrI,OAAA;QAAAgI,QAAA,GAAO9G,cAAc,EAAC,GAAC;MAAA;QAAA2B,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAxF,QAAA,EAAAsF,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC3B,CACN,eAEDrI,OAAA;MAAK+H,SAAS,EAAC,yBAAyB;MAAAC,QAAA,gBACtChI,OAAA;QAAK+H,SAAS,EAAC,uBAAuB;QAACO,KAAK,EAAE;UAAEqB,YAAY,EAAE;QAAS,CAAE;QAAA3B,QAAA,gBACvEhI,OAAA;UACE2E,IAAI,EAAC,QAAQ;UACboD,SAAS,EAAC,iBAAiB;UAC3ByB,OAAO,EAAEA,CAAA;YAAA,IAAAI,qBAAA;YAAA,QAAAA,qBAAA,GAAMpI,aAAa,CAACyC,OAAO,cAAA2F,qBAAA,uBAArBA,qBAAA,CAAuBC,KAAK,CAAC,CAAC;UAAA,CAAC;UAC9Cb,KAAK,EAAC,cAAc;UACpBc,QAAQ,EAAE1I,WAAY;UAAA4G,QAAA,EACvB;QAED;UAAAnF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTrI,OAAA;UACEyJ,GAAG,EAAEjI,aAAc;UACnBmD,IAAI,EAAC,MAAM;UACXoD,SAAS,EAAC,mBAAmB;UAC7BgC,MAAM,EAAC,SAAS;UAChBC,QAAQ,EAAE5F,iBAAkB;UAC5B0F,QAAQ,EAAE1I;QAAY;UAAAyB,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,eAEFrI,OAAA;UACE2E,IAAI,EAAC,QAAQ;UACboD,SAAS,EAAC,iBAAiB;UAC3ByB,OAAO,EAAEA,CAAA;YAAA,IAAAS,qBAAA;YAAA,QAAAA,qBAAA,GAAMxI,YAAY,CAACwC,OAAO,cAAAgG,qBAAA,uBAApBA,qBAAA,CAAsBJ,KAAK,CAAC,CAAC;UAAA,CAAC;UAC7Cb,KAAK,EAAC,aAAa;UACnBc,QAAQ,EAAE1I,WAAY;UAAA4G,QAAA,EACvB;QAED;UAAAnF,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTrI,OAAA;UACEyJ,GAAG,EAAEhI,YAAa;UAClBkD,IAAI,EAAC,MAAM;UACXoD,SAAS,EAAC,mBAAmB;UAC7BiC,QAAQ,EAAEtF,gBAAiB;UAC3BoF,QAAQ,EAAE1I;QAAY;UAAAyB,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC;MAAA;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAENrI,OAAA;QAAMkK,QAAQ,EAAEhE,iBAAkB;QAAC6B,SAAS,EAAC,uBAAuB;QAAAC,QAAA,gBAClEhI,OAAA;UACE+H,SAAS,EAAC,eAAe;UACzBoC,WAAW,EAAE,WAAW/J,MAAM,CAAC0C,QAAQ,KAAM;UAC7CmD,KAAK,EAAEvF,UAAW;UAClBsJ,QAAQ,EAAEvD,YAAa;UACvB2D,UAAU,EAAExD,cAAe;UAC3ByD,IAAI,EAAE,CAAE;UACRP,QAAQ,EAAEhJ,OAAO,IAAIM;QAAY;UAAAyB,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClC,CAAC,eACFrI,OAAA;UACE2E,IAAI,EAAC,QAAQ;UACboD,SAAS,EAAC,aAAa;UACvB+B,QAAQ,EAAE,CAACpJ,UAAU,CAAC0F,IAAI,CAAC,CAAC,IAAItF,OAAO,IAAIM,WAAY;UAAA4G,QAAA,GAEtDlH,OAAO,GAAG,GAAG,GAAG,IAAI,EAAC,OACxB;QAAA;UAAA+B,QAAA,EAAAsF,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAxF,QAAA,EAAAsF,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAxF,QAAA,EAAAsF,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAxF,QAAA,EAAAsF,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC9H,EAAA,CAnfQJ,UAAU;AAAAmK,EAAA,GAAVnK,UAAU;AAqfnB,eAAeA,UAAU;AAAC,IAAAmK,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}